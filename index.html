<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>くじ引き</title>
    <link href="https://fonts.googleapis.com/css?family=Noto+Sans+JP" rel="stylesheet" />
    <link rel="stylesheet" href="./css/kujibiki.css">
</head>
<body>
    <main>
        <p class="typingText"></p>
        <div id="next_button">
            <p class="next"></p>
        </div>
    </main>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

    <!-- タイトル表示 -->
    <script>
        const typingText1 = document.querySelector('.typingText');
        const text1 = 'だれかやれ男くん';
        const typingText2 = document.querySelector('.next');
        const text2 = 'つぎへ';
        let index1 = 0;
        let index2 = 0;

        $(document).ready(function() {
        // HTML要素が確実にロードされた後で要素を取得する！
            const nextButton = document.getElementById('next_button'); 
            const nextUrl = "kujibiki_ready.html";

            function navigateToNextPage() {
                window.location.href = nextUrl; 
            }

            typeText1(nextButton, navigateToNextPage);

        // 一文字ずつ表示する関数1
            function typeText1(button, navigateFn) {
                typingText1.textContent = text1.slice(0, index1);

                if (index1 < text1.length) {
                    index1++;
                    setTimeout(() => typeText1(button, navigateFn), 300);
                } else {
                    // typeText1が終わったらtypeText2を1秒後に開始
                    setTimeout(() => typeText2(button, navigateFn), 1000);
                }

            }      
        
        // 一文字ずつ表示する関数2
            function typeText2(button, navigateFn) {
                typingText2.textContent = text2.slice(0, index2);  

                if (index2 < text2.length) {
                    index2++;
                    setTimeout(() => typeText2(button, navigateFn), 300);
                } else {
                    // タイプライト完了後、0.5秒待ってからクリックイベントを設定
                    setTimeout(function() {
                    // クリックイベントを追加 (ボタンが押されたらページ遷移)
                    $(button).on('click', navigateFn);
                    // ユーザーにクリック可能になったことを示すため、CSSを変更
                    button.classList.add('is-clickable');
                    }, 500);
                }

            }
        });
    </script>
</body>
</html>